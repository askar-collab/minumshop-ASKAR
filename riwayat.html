<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Riwayat Pesanan | MINUMSHOP</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
  font-family:Poppins;
  background:#f8fafc;
  padding:20px
}
h2{text-align:center}

.card{
  background:white;
  padding:18px;
  border-radius:16px;
  margin-bottom:15px;
  box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.badge{
  display:inline-block;
  padding:5px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:700
}
.pending{background:#fde68a;color:#92400e}
.proses{background:#bfdbfe;color:#1e40af}
.selesai{background:#bbf7d0;color:#166534}
.batal{background:#fecaca;color:#991b1b}

button{
  border:none;
  padding:10px 16px;
  border-radius:999px;
  font-weight:700;
  cursor:pointer
}
.detail{background:#0ea5e9;color:white}
.back{background:#64748b;color:white;width:100%;margin-top:20px}
</style>
</head>

<body>

<h2>ðŸ“¦ Riwayat Pesanan</h2>
<div id="list"></div>

<button class="back" onclick="location.href='product-buyer.html'">
â¬… Kembali Belanja
</button>

<script>
/* AUTH */
if(localStorage.getItem("role")!=="buyer"){
  alert("Akses ditolak");
  location.href="login.html";
}

const user = localStorage.getItem("currentUser");
const orders = JSON.parse(localStorage.getItem("orders")) || [];
const myOrders = orders.filter(o=>o.user===user);

const list=document.getElementById("list");

if(myOrders.length===0){
  list.innerHTML="<p style='text-align:center'>Belum ada pesanan</p>";
}

myOrders.forEach((o,i)=>{
  list.innerHTML+=`
  <div class="card">
    <b>ðŸ§¾ Order #${i+1}</b><br>
    <small>${o.tanggal}</small><br><br>

    Total: <b>Rp ${o.total}</b><br>
    Metode: ${o.metode}<br>
    Status: <span class="badge ${o.status}">${o.status.toUpperCase()}</span>
    <br><br>

    <button class="detail" onclick="lihat(${i})">
      Lihat Invoice
    </button>
  </div>`;
});

function lihat(i){
  localStorage.setItem("invoice",JSON.stringify(myOrders[i]));
  location.href="invoice.html";
}
</script>

</body>
</html>
